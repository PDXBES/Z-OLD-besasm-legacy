USE SANDBOX
;




CREATE TABLE SWSP_CULVERT ( 
	culvert_id int identity(1,1)  NOT NULL,
	global_id int NOT NULL,
	survey_page_id int NOT NULL,
	node char(10),
	facing int,
	culvert_opening int,
	shape int,
	full_diam_in float,
	unobstructed_height_in float,
	material int,
	comment varchar(max)
)
;

CREATE TABLE SWSP_CULVERT_OPENING_TYPE ( 
	culvert_opening_type_id int identity(1,1)  NOT NULL,
	culvert_opening char(1) NOT NULL,
	description varchar(50)
)
;

CREATE TABLE SWSP_DITCH ( 
	ditch_id int identity(1,1)  NOT NULL,
	global_id int NOT NULL,
	survey_page_id int NOT NULL,
	node char(10),
	facing int,
	depth_in float,
	top_width_in float,
	bottom_width_in float,
	material int,
	comment varchar(max)
)
;

CREATE TABLE SWSP_EVALUATOR ( 
	evaluator_id int identity(1,1)  NOT NULL,
	initials varchar(3) NOT NULL,
	last_name varchar(30),
	first_name varchar(30)
)
;

CREATE TABLE SWSP_FACING_TYPE ( 
	facing_type_id int identity(1,1)  NOT NULL,
	facing char(1) NOT NULL,
	description varchar(50)
)
;

CREATE TABLE SWSP_GLOBAL_ID ( 
	global_id int identity(1,1)  NOT NULL,
	description varchar(50)
)
;

CREATE TABLE SWSP_MATERIAL_TYPE ( 
	material_type_id int identity(1,1)  NOT NULL,
	material char(6) NOT NULL,
	description varchar(50)
)
;

CREATE TABLE SWSP_PHOTO ( 
	photo_id int identity(1,1)  NOT NULL,
	global_id int NOT NULL,
	location varchar(255),
	comment varchar(max)
)
;

CREATE TABLE SWSP_PIPE ( 
	pipe_id int identity(1,1)  NOT NULL,
	global_id int NOT NULL,
	survey_page_id int NOT NULL,
	us_node char(10),
	ds_node char(10),
	us_depth_in float,
	ds_depth_in float,
	inside_diam_in float,
	material int,
	shape int,
	comment varchar(max)
)
;

CREATE TABLE SWSP_SHAPE_TYPE ( 
	shape_type_id int identity(1,1)  NOT NULL,
	shape varchar(6) NOT NULL,
	description varchar(50)
)
;

CREATE TABLE SWSP_SUBWATERSHED ( 
	subwatershed_id int identity(1,1)  NOT NULL,
	watershed_id int NOT NULL,
	subwatershed varchar(30) NOT NULL,
	description varchar(250)
)
;

CREATE TABLE SWSP_SURVEY_PAGE ( 
	survey_page_id int identity(1,1)  NOT NULL,
	view_id int,
	page_number int,
	date datetime,
	weather varchar(50),
	Comment varchar(max)
)
;

CREATE TABLE SWSP_SURVEY_PAGE_EVALUATOR ( 
	survey_page_id int NOT NULL,
	evaluator_id int NOT NULL
)
;

CREATE TABLE SWSP_VIEW ( 
	view_id int identity(1,1)  NOT NULL,
	subwatershed_id int NOT NULL,
	view_number int NOT NULL,
	description varchar(100)
)
;

CREATE TABLE SWSP_WATERSHED ( 
	watershed_id int identity(1,1)  NOT NULL,
	watershed varchar(30) NOT NULL,
	description varchar(250)
)
;


ALTER TABLE SWSP_CULVERT ADD CONSTRAINT PK_CULVERT 
	PRIMARY KEY CLUSTERED (culvert_id)
;

ALTER TABLE SWSP_CULVERT_OPENING_TYPE ADD CONSTRAINT PK_CULVERT_OPENING_TYPE 
	PRIMARY KEY CLUSTERED (culvert_opening_type_id)
;

ALTER TABLE SWSP_DITCH ADD CONSTRAINT PK_DITCH 
	PRIMARY KEY CLUSTERED (ditch_id)
;

ALTER TABLE SWSP_EVALUATOR ADD CONSTRAINT PK_EVALUATOR 
	PRIMARY KEY CLUSTERED (evaluator_id)
;

ALTER TABLE SWSP_FACING_TYPE ADD CONSTRAINT PK_FACING_TYPE 
	PRIMARY KEY CLUSTERED (facing_type_id)
;

ALTER TABLE SWSP_GLOBAL_ID ADD CONSTRAINT PK_GLOBAL_ID 
	PRIMARY KEY CLUSTERED (global_id)
;

ALTER TABLE SWSP_MATERIAL_TYPE ADD CONSTRAINT PK_MATERIAL_TYPE 
	PRIMARY KEY CLUSTERED (material_type_id)
;

ALTER TABLE SWSP_PHOTO ADD CONSTRAINT PK_PHOTO 
	PRIMARY KEY CLUSTERED (photo_id)
;

ALTER TABLE SWSP_PIPE ADD CONSTRAINT PK_PIPE 
	PRIMARY KEY CLUSTERED (pipe_id)
;

ALTER TABLE SWSP_SHAPE_TYPE ADD CONSTRAINT PK_SHAPE_TYPE 
	PRIMARY KEY CLUSTERED (shape_type_id)
;

ALTER TABLE SWSP_SUBWATERSHED ADD CONSTRAINT PK_SUBWATERSHED 
	PRIMARY KEY CLUSTERED (subwatershed_id)
;

ALTER TABLE SWSP_SURVEY_PAGE ADD CONSTRAINT PK_SURVEY_PAGE 
	PRIMARY KEY CLUSTERED (survey_page_id)
;

ALTER TABLE SWSP_SURVEY_PAGE_EVALUATOR ADD CONSTRAINT PK_SURVEY_PAGE_EVALUATOR 
	PRIMARY KEY CLUSTERED (survey_page_id, evaluator_id)
;

ALTER TABLE SWSP_VIEW ADD CONSTRAINT PK_Views 
	PRIMARY KEY CLUSTERED (view_id)
;

ALTER TABLE SWSP_WATERSHED ADD CONSTRAINT PK_WATERSHED 
	PRIMARY KEY CLUSTERED (watershed_id)
;


ALTER TABLE SWSP_CULVERT
	ADD CONSTRAINT UQ_CULVERT_global_id UNIQUE (global_id)
;

ALTER TABLE SWSP_DITCH
	ADD CONSTRAINT UQ_DITCH_global_id UNIQUE (global_id)
;

ALTER TABLE SWSP_PIPE
	ADD CONSTRAINT UQ_PIPE_global_id UNIQUE (global_id)
;

ALTER TABLE SWSP_SURVEY_PAGE
	ADD CONSTRAINT IDX_viewID_PageNumber UNIQUE (view_id, page_number)
;

ALTER TABLE SWSP_VIEW
	ADD CONSTRAINT IDX_Subwatershed_PageNo UNIQUE (subwatershed_id, view_number)
;


ALTER TABLE SWSP_CULVERT ADD CONSTRAINT FK_CULVERT_CULVERT_OPENING_TYPE 
	FOREIGN KEY (culvert_opening) REFERENCES SWSP_CULVERT_OPENING_TYPE (culvert_opening_type_id)
	ON UPDATE CASCADE
;

ALTER TABLE SWSP_CULVERT ADD CONSTRAINT FK_CULVERT_FACING_TYPE 
	FOREIGN KEY (facing) REFERENCES SWSP_FACING_TYPE (facing_type_id)
	ON UPDATE CASCADE
;

ALTER TABLE SWSP_CULVERT ADD CONSTRAINT FK_CULVERT_MATERIAL_TYPE 
	FOREIGN KEY (material) REFERENCES SWSP_MATERIAL_TYPE (material_type_id)
	ON UPDATE CASCADE
;

ALTER TABLE SWSP_CULVERT ADD CONSTRAINT FK_CULVERT_SHAPE_TYPE 
	FOREIGN KEY (shape) REFERENCES SWSP_SHAPE_TYPE (shape_type_id)
	ON UPDATE CASCADE
;

ALTER TABLE SWSP_CULVERT ADD CONSTRAINT FK_CULVERT_SURVEY_PAGE 
	FOREIGN KEY (survey_page_id) REFERENCES SWSP_SURVEY_PAGE (survey_page_id)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE SWSP_CULVERT ADD CONSTRAINT FK_SWSP_CULVERT_SWSP_GLOBAL_ID 
	FOREIGN KEY (global_id) REFERENCES SWSP_GLOBAL_ID (global_id)
;

ALTER TABLE SWSP_DITCH ADD CONSTRAINT FK_DITCH_FACING_TYPE 
	FOREIGN KEY (facing) REFERENCES SWSP_FACING_TYPE (facing_type_id)
	ON UPDATE CASCADE
;

ALTER TABLE SWSP_DITCH ADD CONSTRAINT FK_DITCH_MATERIAL_TYPE 
	FOREIGN KEY (material) REFERENCES SWSP_MATERIAL_TYPE (material_type_id)
	ON UPDATE CASCADE
;

ALTER TABLE SWSP_DITCH ADD CONSTRAINT FK_DITCH_SURVEY_PAGE 
	FOREIGN KEY (survey_page_id) REFERENCES SWSP_SURVEY_PAGE (survey_page_id)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE SWSP_PHOTO ADD CONSTRAINT FK_PHOTO_CULVERT 
	FOREIGN KEY (global_id) REFERENCES SWSP_CULVERT (global_id)
;

ALTER TABLE SWSP_PHOTO ADD CONSTRAINT FK_PHOTO_DITCH 
	FOREIGN KEY (global_id) REFERENCES SWSP_DITCH (global_id)
;

ALTER TABLE SWSP_PHOTO ADD CONSTRAINT FK_PHOTO_PIPE 
	FOREIGN KEY (global_id) REFERENCES SWSP_PIPE (global_id)
;

ALTER TABLE SWSP_PIPE ADD CONSTRAINT FK_PIPE_MATERIAL_TYPE 
	FOREIGN KEY (material) REFERENCES SWSP_MATERIAL_TYPE (material_type_id)
	ON UPDATE CASCADE
;

ALTER TABLE SWSP_PIPE ADD CONSTRAINT FK_PIPE_SHAPE_TYPE 
	FOREIGN KEY (shape) REFERENCES SWSP_SHAPE_TYPE (shape_type_id)
	ON UPDATE CASCADE
;

ALTER TABLE SWSP_PIPE ADD CONSTRAINT FK_PIPE_SURVEY_PAGE 
	FOREIGN KEY (survey_page_id) REFERENCES SWSP_SURVEY_PAGE (survey_page_id)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE SWSP_PIPE ADD CONSTRAINT FK_SWSP_PIPE_SWSP_GLOBAL_ID 
	FOREIGN KEY (global_id) REFERENCES SWSP_GLOBAL_ID (global_id)
;

ALTER TABLE SWSP_SUBWATERSHED ADD CONSTRAINT FK_SUBWATERSHED_WATERSHED 
	FOREIGN KEY (watershed_id) REFERENCES SWSP_WATERSHED (watershed_id)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE SWSP_SURVEY_PAGE ADD CONSTRAINT FK_SURVEY_PAGE_VIEW 
	FOREIGN KEY (view_id) REFERENCES SWSP_VIEW (view_id)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE SWSP_SURVEY_PAGE_EVALUATOR ADD CONSTRAINT FK_SURVEY_PAGE_EVALUATOR_EVALUATOR 
	FOREIGN KEY (evaluator_id) REFERENCES SWSP_EVALUATOR (evaluator_id)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE SWSP_SURVEY_PAGE_EVALUATOR ADD CONSTRAINT FK_SURVEY_PAGE_EVALUATOR_SURVEY_PAGE 
	FOREIGN KEY (survey_page_id) REFERENCES SWSP_SURVEY_PAGE (survey_page_id)
	ON DELETE CASCADE ON UPDATE CASCADE
;

ALTER TABLE SWSP_VIEW ADD CONSTRAINT FK_VIEW_SUBWATERSHED 
	FOREIGN KEY (subwatershed_id) REFERENCES SWSP_SUBWATERSHED (subwatershed_id)
	ON DELETE CASCADE ON UPDATE CASCADE
;
