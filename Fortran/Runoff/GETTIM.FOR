C       PROGRAM TEST
C      INTEGER*2 HH,MM,SS,HD
C      INTEGER*2 YYYY,MO,DD
C      CALL GETTIM(HH,MM,SS,HD)
C      WRITE(6,*) HH,MM,SS,HD
C      CALL GETDAT(YYYY,MO,DD)
C      WRITE(6,*) MO,DD,YYYY
C      END

      SUBROUTINE GETTIM(HH,MM,SS,HD)
C   SUBROUTINE TO REPLICATE RMFORTRAN GETTIM ROUTINE
C   RETURNS SYSTEM TIME AS FOUR ARGUMENTS 
C      HH - HOUR  <0-23>
C      MM - MINUTE <0-59>
C      SS - SECONDS <0-60>
C      HD - HUNDREDTHS OF A SECOND <0-99>
C    Chuck Moore 11-92
C
       INTEGER*2 HH,MM,SS,HD
       CHARACTER*11 CTIME
C  FOLLOWING IS LAHEY TIME ROUTINE - RETURNS CHARACTER
C  IN FORM OF hh:mm:ss.hh 
       CALL TIME(CTIME)
       HH=(ICHAR(CTIME(1:1))-48)*10 + (ICHAR(CTIME(2:2))-48)
       MM=(ICHAR(CTIME(4:4))-48)*10 + (ICHAR(CTIME(5:5))-48)
       SS=(ICHAR(CTIME(7:7))-48)*10 + (ICHAR(CTIME(8:8))-48)
       HD=(ICHAR(CTIME(10:10))-48)*10 + (ICHAR(CTIME(11:11))-48)
       RETURN 
       END


      SUBROUTINE GETDAT(YYYY,MM,DD) 
C   SUBROUTINE TO REPLICATE RMFORTRAN GETTIM ROUTINE
C   RETURNS SYSTEM TIME AS FOUR ARGUMENTS 
C      YYYY - YEAR <1980-2099
C      MM - MONTH  <1-12>
C      DD - DAY <1-31>
C    Chuck Moore 11-92
C
       INTEGER*2 YYYY,MM,DD 
       CHARACTER*8  CDATE
C  FOLLOWING IS LAHEY DATE ROUTINE - RETURNS CHARACTER
C  IN FORM OF MM/DD/YY   EACH ARE TWO DIGITS
       CALL DATE(CDATE)
       YYYY=(ICHAR(CDATE(7:7))-48)*10 + (ICHAR(CDATE(8:8))-48) + 1900
       MM=(ICHAR(CDATE(1:1))-48)*10 + (ICHAR(CDATE(2:2))-48)
       DD=(ICHAR(CDATE(4:4))-48)*10 + (ICHAR(CDATE(5:5))-48)
       RETURN 
       END
